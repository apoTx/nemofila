app.controller("newAdController",["$scope","Upload","$timeout","$http",(e,t,o,a)=>{e.newAdForm={},e.steps={},e.steps.informations=!0,e.steps.preview=!1,$(()=>{$("#newAdForm").form(),e.newAdForm.anotherContact={},$(".ui.checkbox").checkbox({onChecked:()=>{e.newAdForm.anotherContact.checked=!0,setTimeout(()=>{$('input[name="anotherContactName"]').focus()},20)},onUnchecked:()=>{e.newAdForm.anotherContact.checked=!1},onChange:()=>{e.$apply()}})}),e.nextLoader=!1,e.uploadFiles=function(a){e.nextLoader=!0,a&&a.length&&t.upload({url:"newAd/uploadPhotos",method:"POST",file:a}).then(t=>{o(()=>{e.result=t.data,1==t.data.status&&e.saveAdToRedis(t.data.uuid,t.data.photos)})},t=>{t.status>0&&(e.errorMsg=t.status+": "+t.data)},t=>{e.progress=Math.min(100,parseInt(100*t.loaded/t.total))})},e.saveAdToRedis=((t,o)=>{e.newAdBtnLoading=!0,a({url:"/newAd/saveAdRedis",method:"POST",data:{data:e.newAdForm,uuid:t,photos:o}}).then(t=>{e.newAdBtnLoading=!1,1==t.data.status&&n()},()=>{console.log("fail")})});let n=()=>{e.steps.informations=!1,e.steps.preview=!0,e.nextLoader=!1}}]);