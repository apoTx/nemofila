app.controller("newAdController",["$scope","Upload","$timeout","$http",(e,t,o,a)=>{e.newAdForm={},e.steps={},e.steps.informations=!0,e.steps.preview=!1,$(()=>{$("#newAdForm").form(),e.newAdForm.anotherContact={},$(".ui.checkbox").checkbox({onChecked:()=>{e.newAdForm.anotherContact.checked=!0,setTimeout(()=>{$('input[name="anotherContactName"]').focus()},20)},onUnchecked:()=>{e.newAdForm.anotherContact.checked=!1},onChange:()=>{e.$apply()}})}),e.uploadFiles=function(a,n,d){a&&a.length&&t.upload({url:"newAd/uploadPhotos/"+n,method:"POST",file:a,data:{veri:1}}).then(t=>{o(()=>{e.result=t.data,1==t.data.status&&d()})},t=>{t.status>0&&(e.errorMsg=t.status+": "+t.data,d(e.errorMsg))},t=>{e.progress=Math.min(100,parseInt(100*t.loaded/t.total))})},e.saveAd=(()=>{e.newAdBtnLoading=!0,a({url:"/newAd/saveAdBuffer",method:"POST",data:{data:e.newAdForm}}).then(t=>{e.newAdBtnLoading=!1,1==t.data.status&&(e.newAdForm.files?e.uploadFiles(e.newAdForm.files,t.data.uuid,e=>{if(e)throw e;n()}):n())},()=>{console.log("fail")})});let n=()=>{e.steps.informations=!1,e.steps.preview=!0}}]);