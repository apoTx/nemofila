app.controller("newAdController",["$scope","Upload","$timeout","$http",(e,o,s,n)=>{e.newAdForm={},e.steps={},e.steps.informations=!0,e.steps.preview=!1,$(()=>{$("#newAdForm").form(),e.newAdForm.anotherContact={},$(".ui.checkbox").checkbox({onChecked:()=>{e.newAdForm.anotherContact.checked=!0,setTimeout(()=>{$('input[name="anotherContactName"]').focus()},20)},onUnchecked:()=>{e.newAdForm.anotherContact.checked=!1},onChange:()=>{e.$apply()}})}),e.uploadAndSaveRedis=(()=>{e.newAdForm.files?e.uploadFiles(e.newAdForm.files):e.saveAdToRedis(null,null)}),e.newAdForm.showcaseIndex=0,e.onPhotoSelect=(()=>{e.newAdForm.files[e.newAdForm.showcaseIndex].showcase=!0}),e.onDeletePhoto=(o=>{e.newAdForm.files[o].showcase&&(e.newAdForm.files[1]&&!e.newAdForm.files[1].showcase?(e.newAdForm.files[1].showcase=!0,e.newAdForm.showcaseIndex=1):(e.newAdForm.files[0].showcase=!0,e.newAdForm.showcaseIndex=0)),e.newAdForm.files.splice(o,1)}),e.onSelectShowCase=(o=>{e.newAdForm.files[e.newAdForm.showcaseIndex].showcase=!1,e.newAdForm.showcaseIndex=o,e.newAdForm.files[o].showcase=!0}),e.nextLoader=!1,e.uploadFiles=(n=>{e.nextLoader=!0,n&&n.length&&o.upload({url:"newAd/uploadPhotos",method:"POST",file:n}).then(o=>{s(()=>{e.result=o.data,1===o.data.status&&e.saveAdToRedis(o.data.uuid,o.data.photos)})},o=>{o.status>0&&(e.errorMsg=o.status+": "+o.data)},o=>{e.progress=Math.min(100,parseInt(100*o.loaded/o.total))})}),e.saveAdToRedis=((o,s)=>{e.newAdBtnLoading=!0;var a;a=null!==o?{data:e.newAdForm,uuid:o,photos:s}:{data:e.newAdForm},n({url:"/newAd/saveAdRedis",method:"POST",data:a}).then(o=>{e.newAdBtnLoading=!1,1===o.data.status&&d()},()=>{console.log("fail")})});let d=()=>{e.openSignInModal(),a(),e.nextLoader=!1},a=()=>{e.steps.informations=!1,e.steps.preview=!0}}]);