app.controller("profileEditController",["$scope","Upload","$timeout","$http","$window","config","profileEditFactory","guidFactory",(o,e,t,l,a,i,r,p)=>{o.profilePhotoForm={},o.init=(e=>{o.profilePhotoForm.photo=e}),o.uploadAndSaveMongo=((e,t)=>{o.profilePhotoForm.files&&r.get_s3_signature().then(l=>{o.uploadFiles(e,t,l.inputs)})}),o.uploading=!1,o.uploadFiles=((t,l,a)=>{if(o.uploading=!0,t){let d=l.split("."),n=d[d.length-1],u=p.generateGuid()+"."+n;e.upload({url:i.s3_upload_url,method:"POST",data:{key:u,acl:a.acl,policy:a.policy,"X-amz-signature":a.X_amz_signature,"X-amz-credential":a.x_amz_credential,"X-amz-algorithm":a.X_amz_algorithm,"X-amz-date":a.X_amz_date,"Content-Type":""!=t.type?t.type:"application/octet-stream",filename:u,file:e.dataUrltoBlob(t,u)}}).then(e=>{o.result=e.data,o.uploading=!1,r.updatePhotoUrl(u).then(e=>{o.profilePhotoForm.photo=e.profilePictureUrl,o.profilePhotoForm.files=[],o.closeUploadProfilePictureModal()})},e=>{e.status>0&&(o.errorMsg=e.status+": "+e.data)},e=>{o.progress=Math.min(100,parseInt(100*e.loaded/e.total))})}}),o.triggerUploadWindow=(()=>{$('input[type="file"]').trigger("click")}),o.openUploadProfilePictureModal=(()=>{$("#uploadProfilePictureModal").modal("show")}),o.closeUploadProfilePictureModal=(()=>{$("#uploadProfilePictureModal").modal("hide")})}]);