app.controller("profileEditController",["$scope","Upload","$timeout","$http","$window","config","profileEditFactory","guidFactory",(o,e,l,t,a,i,r,d)=>{o.profilePhotoForm={},o.file="",o.init=(e=>{o.profilePhotoForm.photo=e}),o.uploadAndSaveMongo=((e,l)=>{r.get_s3_signature().then(t=>{o.uploadFiles(e,l,t.inputs)})}),o.uploading=!1,o.uploadFiles=((l,t,a)=>{if(o.uploading=!0,l){let p=t.split("."),u=p[p.length-1],n=d.generateGuid()+"."+u;e.upload({url:i.s3_upload_url,method:"POST",data:{key:n,acl:a.acl,policy:a.policy,"X-amz-signature":a.X_amz_signature,"X-amz-credential":a.x_amz_credential,"X-amz-algorithm":a.X_amz_algorithm,"X-amz-date":a.X_amz_date,"Content-Type":""!=l.type?l.type:"application/octet-stream",filename:n,file:e.dataUrltoBlob(l,n)}}).then(e=>{o.result=e.data,o.uploading=!1,r.updatePhotoUrl(n).then(e=>{o.profilePhotoForm.photo=e.profilePictureUrl,o.profilePhotoForm.files=[],o.closeUploadProfilePictureModal()})},e=>{e.status>0&&(o.errorMsg=e.status+": "+e.data)},e=>{o.progress=parseInt(100*e.loaded/e.total)})}}),o.openUploadProfilePictureModal=(()=>{$("#uploadProfilePictureModal").modal("show")}),o.closeUploadProfilePictureModal=(()=>{$("#uploadProfilePictureModal").modal("hide")})}]);