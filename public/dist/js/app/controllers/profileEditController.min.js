app.controller("profileEditController",["$scope","Upload","$timeout","$http","$window","config","profileEditFactory","guidFactory",(o,l,e,t,a,i,r,d)=>{o.profilePhotoForm={},o.file="",o.init=(l=>{o.profilePhotoForm.photo=l}),o.uploadAndSaveMongo=((l,e)=>{r.get_s3_signature().then(t=>{console.log(t),o.uploadFiles(l,e,t.inputs)})}),o.uploading=!1,o.uploadFiles=((e,t,a)=>{if(o.uploading=!0,e){let p=t.split("."),u=p[p.length-1],n=d.generateGuid()+"."+u;l.upload({url:i.s3_upload_url,method:"POST",data:{key:n,acl:a.acl,policy:a.policy,"X-amz-signature":a.X_amz_signature,"X-amz-credential":a.x_amz_credential,"X-amz-algorithm":a.X_amz_algorithm,"X-amz-date":a.X_amz_date,"Content-Type":""!=e.type?e.type:"application/octet-stream",filename:n,file:l.dataUrltoBlob(e,n)}}).then(l=>{o.result=l.data,o.uploading=!1,r.updatePhotoUrl(n).then(l=>{o.profilePhotoForm.photo=l.profilePictureUrl,o.profilePhotoForm.files=[],o.closeUploadProfilePictureModal()})},l=>{l.status>0&&(o.errorMsg=l.status+": "+l.data)},l=>{o.progress=parseInt(100*l.loaded/l.total)})}}),o.openUploadProfilePictureModal=(()=>{$("#uploadProfilePictureModal").modal("show")}),o.closeUploadProfilePictureModal=(()=>{$("#uploadProfilePictureModal").modal("hide")})}]);