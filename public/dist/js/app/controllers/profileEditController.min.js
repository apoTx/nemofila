app.controller("profileEditController",["$scope","Upload","$timeout","$http","$window","config","profileEditFactory",(o,t,l,e,a,r,i)=>{function p(){function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}o.profilePhotoForm={},o.init=(t=>{o.profilePhotoForm.photo=t}),o.uploadAndSaveMongo=((t,l)=>{o.profilePhotoForm.files&&o.uploadFiles(t,l)}),o.uploading=!1,o.uploadFiles=((l,e)=>{if(o.uploading=!0,l){let a=e.split("."),d=a[a.length-1],n=p()+"."+d;t.upload({url:r.s3_upload_url,method:"POST",data:{key:n,acl:o.acl,policy:o.policy,"X-amz-signature":o.X_amz_signature,"X-amz-credential":o.x_amz_credential,"X-amz-algorithm":o.X_amz_algorithm,"X-amz-date":o.X_amz_date,"Content-Type":""!=l.type?l.type:"application/octet-stream",filename:n,file:t.dataUrltoBlob(l,n)}}).then(t=>{o.result=t.data,o.uploading=!1,i.updatePhotoUrl(n).then(t=>{o.profilePhotoForm.photo=t.profilePictureUrl,o.profilePhotoForm.files=[],o.closeUploadProfilePictureModal()})},t=>{t.status>0&&(o.errorMsg=t.status+": "+t.data)},t=>{o.progress=Math.min(100,parseInt(100*t.loaded/t.total))})}}),o.triggerUploadWindow=(()=>{$('input[type="file"]').trigger("click")}),o.openUploadProfilePictureModal=(()=>{$("#uploadProfilePictureModal").modal("show")}),o.closeUploadProfilePictureModal=(()=>{$("#uploadProfilePictureModal").modal("hide")})}]);