app.controller("messagesController",["$scope","messageFactory","$routeParams",function(e,s,a){function n(){setTimeout(()=>{o.scrollTop=o.scrollHeight},1)}let o=document.getElementById("messageList");e.sendMessageFormData={},e.loadingMessages=!1,e.loadingConversations=!0,s.getConversations().then(s=>{e.loadingConversations=!1,e.conversations=s}),a.id&&(e.sendMessageFormData.conversationId=a.id,e.visibleMessages=!0,e.loadingMessages=!0,s.getMessages(a.id).then(s=>{e.loadingMessages=!1,e.messages=s,n()})),e.messageSended=!1,e.sendMessage=(()=>{e.sendMessageLoading=!0,s.createMessage(e.sendMessageFormData,e.sendMessageFormData.conversationId).then(s=>{if(e.sendMessageLoading=!1,1!==s.status)return e.sendMessageErr=s.error,!1;e.messages.push({message:e.sendMessageFormData.message,createdAt:new Date,user:{name:e.sendMessageFormData.username,surname:e.sendMessageFormData.surname}}),e.sendMessageFormData.message="",n()})})}]);