app.controller("myCtrl",["$scope","$http","Slug",function(e,i,t){e.filmDescription={},e.filmTitle={},e.subtitle={},e.metaTitle={},e.metaDescription={},e.isEdit=!1;var l,n=$("#imdb_id_div");e.slugify=function(i){e.slug=t.slugify(i)},e.update=function(t){if("undefined"!=t){e.isEdit=!0,e.filmPosterImdb=!0;var t=t;i.get("/api/movie/detailById/"+t+"/?api_key="+movielab_api_settings.api_key).then(function(i){var t=i.data;e.imdb_id=t.imdb_id,e.imdbScore=t.imdb_score,e.filmTitle.en=t.lang.en.title,e.filmTitle.tr=t.lang.tr.title,e.filmTitle.mk=t.lang.mk.title,e.filmTitle.sr=t.lang.sr.title,e.filmTitle.hr=t.lang.hr.title,e.filmTitle.es=t.lang.es.title,e.filmTitle.bg=t.lang.bg.title,e.filmDescription.en=t.lang.en.description,e.filmDescription.tr=t.lang.tr.description,e.filmDescription.mk=t.lang.mk.description,e.filmDescription.sr=t.lang.sr.description,e.filmDescription.hr=t.lang.hr.description,e.filmDescription.es=t.lang.es.description,e.filmDescription.bg=t.lang.bg.description,e.metaTitle.tr=t.lang.tr.metaTitle,e.metaDescription.tr=t.lang.tr.metaDescription,e.hours=t.hours,e.minutes=t.minutes,e.releaseYear=t.release_year,e.releaseCountry=t.release_country,e.director=t.director,e.status=t.active,e.categories=t.categories,e.metaTitle.tr=t.lang.tr.metaTitle,e.metaDescription.tr=t.lang.tr.metaDescription,e.driveId=t.drive_id,e.driveTrailerId=t.drive_id_trailer,e.subtitle.en=t.lang.en.subtitle,e.subtitle.tr=t.lang.tr.subtitle,e.subtitle.mk=t.lang.mk.subtitle,e.subtitle.sr=t.lang.sr.subtitle,e.subtitle.hr=t.lang.hr.subtitle,e.subtitle.es=t.lang.es.subtitle,e.subtitle.bg=t.lang.bg.subtitle,e.slug=t.slug,e.folderGuid=t.folder_guid,l=t.cover,e.filmPoster="/uploads/"+e.folderGuid+"/cover/w185/"+t.cover,e.filmPoster2="/uploads/"+e.folderGuid+"/cover/w300/"+t.cover})}},e.getFilmInfo_viaImdbID=function(t){setTimeout(function(){function t(){var t=r+"&language=",l=t+"en";i.get(l).then(function(i){var t=i.data;e.filmTitle.en=t.title,e.filmDescription.en=t.overview},function(e){console.log(e)});var n=t+"tr";i.get(n).then(function(i){var t=i.data;e.filmTitle.tr=t.title,e.filmDescription.tr=t.overview,setTimeout(function(){e.filmTitle.en!=e.filmTitle.tr?e.metaTitle.tr=e.filmTitle.en+" - "+e.filmTitle.tr+" altyaz覺l覺 izle 1080p HD":e.metaTitle.tr=e.filmTitle.en+" altyaz覺l覺 izle 1080p HD"},100),$("#tr-tab").removeClass("loading")},function(e){console.log(e)});var o=t+"mk";i.get(o).then(function(i){var t=i.data;e.filmTitle.mk=t.title,e.filmDescription.mk=t.overview},function(e){console.log(e)});var a=t+"sr";i.get(a).then(function(i){var t=i.data;e.filmTitle.sr=t.title,e.filmDescription.sr=t.overview},function(e){console.log(e)});var s=t+"hr";i.get(s).then(function(i){var t=i.data;e.filmTitle.hr=t.title,e.filmDescription.hr=t.overview},function(e){console.log(e)});var m=t+"es";i.get(m).then(function(i){var t=i.data;e.filmTitle.es=t.title,e.filmDescription.es=t.overview},function(e){console.log(e)});var d=t+"bg";i.get(d).then(function(i){var t=i.data;e.filmTitle.bg=t.title,e.filmDescription.bg=t.overview},function(e){console.log(e)})}n.addClass("loading");var r=themoviedb_api_settings.api_base_url+"movie/"+e.imdb_id+"?api_key="+themoviedb_api_settings.api_key;i.get(r).then(function(r){var o=r.data,a=o.runtime;e.hours=Math.floor(a/60),e.minutes=a-60*e.hours,e.categories=o.genres;var s=o.release_date;e.releaseYear=s.split("-")[0],l=o.poster_path,e.bgFromImdbFileName=o.backdrop_path;var m=omdb_api_settings.api_base_url+"?i="+e.imdb_id;i.get(m).then(function(i){var t=i.data;e.releaseCountry=t.Country,e.imdbScore=t.imdbRating,e.director=t.Director,n.removeClass("loading")},function(e){console.log(e),n.removeClass("loading")}),t(),e.getFilmPoster()},function(e){console.log(e),n.removeClass("loading")})},1)},e.filmPosterImdb=!1,e.getFilmPoster=function(){$("#get_imdb_poster").addClass("loading"),e.posterFromImdbFileName=l,e.filmPoster=themoviedb_api_settings.api_image_download_base+"w185"+l,e.filmPoster2=themoviedb_api_settings.api_image_download_base+"w300"+l,e.filmPosterImdb=!0},e.uploadFilmPoster=function(){e.$apply(function(i){e.filmPosterImdb=!1})}}]),app.directive("imageonload",function(){return{restrict:"A",link:function(e,i,t){i.bind("load",function(){$("#get_imdb_poster").removeClass("loading")}),i.bind("error",function(){alert("image could not be loaded")})}}});