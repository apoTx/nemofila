extends layout

append stylesheets

block content

    div.ui.main.container.subPage(ng-controller="profileEditsController")
        div(ng-if="!adSaveComplete", ng-cloak)

            div#adInformation
                form.ui.form.fluid#profilePhotoForm
                    input(type='hidden', name='Content-Type', value='')
                    input(type='hidden', name='Content-Type', ng-init="url= '#{ formdata.url }' ", ng-model="url")
                    input(type='hidden', name='acl', ng-model="acl", ng-init="acl= '#{ formdata.inputs.acl }'")
                    input(type='hidden', name='success_action_status', ng-model="success_action_status", ng-init="success_action_status= '#{ formdata.inputs.success_action_status }'" )
                    input(type='hidden', name='policy', ng-model="policy", ng-init="policy = '#{ formdata.inputs.policy }'")
                    input(type='hidden', name='X-amz-credential', ng-model="x_amz_credential", ng-init="x_amz_credential= '#{ formdata.inputs['X-amz-credential'] }'")
                    input(type='hidden', name='X-amz-algorithm', ng-model="X_amz_algorithm", ng-init="X_amz_algorithm = '#{ formdata.inputs['X-amz-algorithm'] }'")
                    input(type='hidden', name='X-amz-date', ng-model="X_amz_date", ng-init="X_amz_date = '#{ formdata.inputs['X-amz-date'] }'")
                    input(type='hidden', name='X-amz-expires', ng-model="X_amz_expires", ng-init="X_amz_expires = '#{ formdata.inputs['X-amz-expires'] }'")
                    input(type='hidden', name='X-amz-signature', ng-model="X_amz_signature", ng-init="X_amz_signature = '#{ formdata.inputs['X-amz-signature'] }'")

                    .ui.tiny.stacked.segment
                        .text-center
                            .ui.labeled.button(tabindex='0', ng-click='triggerUploadWindow()')
                                .ui.button
                                    i.upload.icon
                                    |  #{ i18n.__("upload_photos") }
                                a.ui.basic.label
                                    | {{ profilePhotoForm.files.length > 0 ? profilePhotoForm.files.length : '0'  }}
                            input(
                                type='file',
                                style="width:30%"
                                ngf-select='',
                                ng-model='profilePhotoForm.files',
                                name='photos',
                                class='hidden'
                                ngf-fix-orientation="true",
                                ngf-pattern="'image/*'",
                                ngf-accept="'image/*'",
                                ngf-max-size='4MB',
                                ngf-multiple='true',
                                ngf-keep='true',
                                ngf-keep-distinct='true',
                                ngf-max-files="10",
                                ngf-model-invalid="invalidFiles",
                                ngf-resize="{ quality: .7 }"
                            )

                        .clearfix &nbsp;
                        .ui.warning.message.margin-bottom-30(ng-show="invalidFiles.length > 0",style="display:block")
                            .header
                                | #{ i18n.__("photo_size_limit") }

                        .ui.four.stackable.cards
                            .card.photoList(ng-repeat='f in profilePhotoForm.files')
                                .image.photoListImage
                                    a.ui.left.corner.label(ng-if="f.showcase", ng-cloak)
                                        i.bookmark.icon.orange
                                    img(
                                        ngf-thumbnail="f.filename ? '#{ amazon_base_url }/{{f.filename}}': f ",
                                        ngf-size="{width:200, height:200, quality:0.6}",
                                        ng-src="img/spinner.gif",
                                        class="upload-photo-thumb"
                                    )

                                    span.progress(ng-hide="f.progressFinish", ng-if="f.progress >= 0")
                                        div(style='width:{{f.progress}}%', ng-bind="f.progress + '%'")


                                .ui.bottom.attached.button.noRadius(
                                    ng-click="onDeletePhoto($index)",
                                    ng-if="f.showcase",
                                    ng-cloak
                                )
                                    i.remove.icon.
                                    |  #{ i18n.__("remove") }


                            | {{errorMsg}}


                    .ui.error.message
                    .backendErr.ui.red.message(ng-if="newAdErr", ng-cloak)
                        | {{ newAdErr }}

                    button.ui.right.floated.primary.button(
                        ng-click="uploadAndSaveMongo('#{ id }')",
                        ng-class="uploading ? 'loading disabled' : '' "
                    ) Save

append javascripts
    script(src="/js/app/controllers/profileEditsController.js")

